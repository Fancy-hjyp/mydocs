---
title: 参数类型对应机制
description: 参数类型对应机制
tags: [MyBatis]
date: 2025-08-10
weight: 5
---

# 参数类型对应机制
Java数据类型与数据库字段类型对应关系如下：
| Java 类型 | 数据库字段类型 |
| --------- | ------------- |
| Integer       | INTEGER       |
| String    | VARCHAR       |
| Date      | DATETIME          |
| Boolean   | TINYINT       |
| Long      | BIGINT        |
| Short      | SMALLINT         |
| Float      | FLOAT          |
| Double      | DOUBLE          |
| Byte      | TINYINT          |
| Char      | TINYINT          |

这里需要注意的是，布尔值在JAVA中占据一个bit，但是数据库中占据一个字节，8个比特，因为Mysql数据库最少占一个字节，所以布尔值在数据库中需要占据一个字节。

# 转换原理
在Mybatis中，针对每种内置的基础数据类型都有对应的类型转换器，在执行SQL或处理数据库返回值时，Mybatis会调用对应的类型转换器将Java类型转为数据库字段类型或将数据库字段类型转换为Java类型。

比如，age字段的类型是Integer，在执行SQL时，Mybatis会调用Integer转换器将数字转为文本表示格式，如insert into user(age) values(18)；

当执行结果返回后，因为所有的数据都是以文本形式传输，18传输的是字符1和字符8，而不是一个字节，此时，Mybatis会调用Integer.valueOf()方法将字符串转为Integer对象。

# 数据类型不一致的转换
在编写代码时，Java类型与数据库字段类型最好要按照上面的字段类型对表一一对应。
但是极特殊情况下，Java类型可能会与数据库类型出现不一致的情况，比如Java类型是String，数据库字段类型是Date；Java数据类型是Integer，而数据库字段类型是VARCHAR。
Mybatis可以完成一些数据类型间的转换。

可以转换的类型如下：
| Java 类型 | 兼容的数据库字段类型 |
| --------- | ------------- |
| Integer       | INT、VARCHEAR、TINYINT      |
| String    | VARCHAR、INT、TINYINT、DATETIME   |
| Date      | DATETIME、VARCHAR        |
| Boolean   | TINYINT、INT、VARCHAR      |

从上表可以看到，Mysql可以将String类型转换为Date类型

## 数值类型间的转换
比如Java类型可以是Integer，数据库类型可以是TINYINT。
数值类型间的转换是允许的，但是需要注意数值类型的范围。比如将Integer转为TINYINT时，不能超过TINYINT的最大值，否则会报错。


## 字符串与数值类型的转换
在Mybatis中可以完成字符串与数值类型进行转换，比如可以设置Java类型为String，而数据库类型为Integer；也可以设置Java类型为Integer，而数据库类型为VARCHAR。

假设字段age类型是String，而数据库类型为INTEGER，那么在生成SQL语句时，Mybatis会生成一个参数为String的SQL语句，例如：insert into user(age) values('18')，注意18旁边的单引号，说明输入参数为String类型；但是执行这条SQL语句时，数据库会自动将String类型的参数转换为INTEGER类型，不会报错；

处理SQL返回结果时，Mybatis会自动将数据库返回的INTEGER类型转换为String类型，不会报错；

当字段age类型为Integer，而数据库字段类型为String时，Mybatis会生成一个参数为String的SQL语句，例如：insert into user(age) values(18)，注意这次18没有单引号，说明输入参数为Integer类型；但是执行这条SQL语句时，数据库会自动将Integer类型的参数转换为VARCHAR类型，不会报错；

处理SQL返回结果时，Mybatis会自动将数据库返回的VARCHAR类型转换为Integer类型，不会报错；

**示例**：
Mapper接口定义如下：
```java
List<User> selectUserByAgeString(String age);
```
其中，数据库中age字段是Integer类型，而方法参数age是String类型。
在Mapper.xml文件中，可以直接使用#{age}来引用方法参数age。
```xml
<select id="selectUserByAgeString" resultType="com.example.mybatis.entity.User">
    SELECT * FROM user WHERE age = #{age}
    </select>
```

这是因为数据库会自动将参数值转换为字段的类型。，比如数据库中的age是int类型，但是 select * from user where age = '20'仍然会正常执行;
说明：
* 如果传入的参数是 "20"，数据库会将其转换为 INTEGER 并执行查询。
* 如果传入的参数是 "abc"，数据库会尝试将其转换为 INTEGER，但会失败并抛出错误。
* 为了避免潜在的错误，建议在 Java 层定义数据类型时与数据库保持一致。


并不是所有的类型mysql都会自动转换，string与int之间自动转换的前提是string是数字字符串。


## Date与String类型的转换
假设字段birthday类型是Date，而数据库类型为VARCHAR，那么在生成SQL语句时，Mybatis会生成一个参数为Date的SQL语句，例如：insert into user(birthday) values('2025-08-03')，注意2025-08-03的双引号，说明输入参数为Date类型；但是执行这条SQL语句时，数据库会自动将Date类型的参数转换为VARCHAR类型，不会报错；

处理SQL返回结果时，Mybatis会自动将数据库返回的VARCHAR类型转换为Date类型，不会报错；

当字段birthday类型为String，而数据库类型为DATETIME类型时，在生成SQL语句时，会自动将字段birthday转换为VARCHAR类型，如：insert into user(birthday) values('2025-08-10')，正常执行SQL插入数据；

处理SQL返回值时，Mybatis会自动将数据库返回的DATETIME类型转换为Date类型，不会报错；


## Boolean与TINYINT类型的转换
当字段flag为Boolean类型时，在生成SQL语句时，会自动将字段flag转换为TINYINT类型，当flag为True时：insert into user(flag) values(1)，正常执行SQL插入数据；
如果flag为falsese，则insert into user(flag) values(0)，正常执行SQL插入数据；

处理查询SQL返回值时，Mybatis会自动将TINYINT类型转换为Boolean类型，如果返回0则为False，返回1则为True；

小知识，但其实直接插入True或者false数据库也能正常运行，比如：insert into user(flag) values(true)，insert into user(flag) values(false)，只不过Mybatis将Boolean转为TINYINT类型，返回0或者1的方式更好一些。


假设现在 User 对象的 `age` 属性是 `String` 类型，而数据库中的 `age` 字段是 `INTEGER` 类型。

MyBatis 不会对参数类型进行转换，而是将参数值直接传递给数据库。数据库会尝试将参数值转换为字段的类型（如果可能）。